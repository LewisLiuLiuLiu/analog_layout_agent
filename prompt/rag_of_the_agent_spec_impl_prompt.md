你现在的角色是：熟悉 RAG 系统与向量数据库的后端工程师，负责把高层设计变成可实现的技术规格。

【输入上下文】
- 我会提供《opamp_layout_gen_Agent_proposal.md》全文。
- 其中 1.2 节已经描述了 RAG 知识库的构建（Markdown 预处理、Chunking、Embedding、向量库、Retriever 优化等）。
- 你的任务是基于 proposal，**生成“工程实现文档”的 RAG 知识库实现章节**。

【输出目标】
写出一章可以直接指导工程师实现的“RAG 知识库实现规格”，覆盖从文档到在线检索的完整链路。

【输出内容结构要求】
建议的章节结构如下（可按需要细化）：
1. RAG 知识库总体设计
   - 简要说明 RAG 在本系统中的作用和边界（只覆盖版图技巧文档，不包含运行时记忆）。

2. 文档来源与预处理流程
   - 支持的原始格式（PDF/Word/Markdown），以及最终统一为 Markdown 的要求。
   - Markdown 预处理管线：
     - 编码与格式清洗
     - 标题层级解析（H1/H2/H3）
     - 列表、代码块保留策略
   - 可以给出一个“预处理流程图”的文字说明。

3. 切片（Chunking）策略规格
   - **结构化切片**规则：
     - 以 H2/H3 为基本块的边界，最大/最小 token 数控制。
   - **语义切片**规则：
     - 句子分割方法（可以推荐一种具体做法，如基于句号/分号 + 简单 NLP 分句）。
     - 滑动窗口参数（窗口大小、步长）。
   - Chunk 元数据定义：
     - 例如：`{id, doc_id, title_path, start_line, end_line, tokens, tags}`。

4. 嵌入模型与向量数据库选型与配置
   - 推荐的嵌入模型（例如某类中英文混合模型），并说明选择理由。
   - 向量数据库选型（如 Chroma / Pinecone / Elasticsearch）：
     - 索引结构（向量维度、度量方式：余弦/内积）。
     - 命名空间设计（按文档集 / 语言 / 主题？）。
   - 索引更新策略：
     - 初始构建、增量更新、重建条件。

5. 检索器（Retriever）实现细节
   - 查询改写（Query Rewriting）策略：
     - 何时触发、如何使用 LLM 生成查询变体。
   - 混合检索（Hybrid Search）：
     - 关键词检索（BM25 类）、向量检索的结合方式。
     - 结果融合算法（例如简要规格 RRF）。
   - 重排序（Reranking）：
     - 是否使用交叉编码器，如何配置 Top-K → Top-N。
   - 对外暴露接口规格：
     - 举例说明检索函数签名：`retrieve_knowledge(query: str, context: RetrievalContext) -> List[Chunk]`。
     - 输入包含哪些上下文（当前任务类型、模块信息）用于上下文感知检索。

6. 与 Agent 规划模块的集成方式
   - 描述规划模块在何处/以何种形式调用 RAG：
     - 例如：规划前先检索，或在遇到不确定布局策略时按需检索。
   - 对规划模块的返回格式约定（例如限定为最多 N 条、每条附上来源信息）。

7. 监控与评估
   - 给出基本的 RAG 质量评估指标（如命中率、用户纠正次数）。
   - 日志与抽样人工检查策略的建议。

【技术深度要求】
- 需要写到“**可以据此实现一个 RAG 服务**”的程度：
  - 明确说明关键配置项（向量维度、Top-K 取值范围、chunk 大小建议值）。
  - 给出关键数据结构字段定义（名称、类型、含义）。
- 不要求绑定具体开源项目，但可以给出推荐组合（例如：Python + 某嵌入模型 + 某向量库）。

【与整体项目关联性要求】
- RAG 主要服务于“版图技巧文档”的知识，注意区分与 Agent Memory（长期记忆）的角色。
- RAG 的接口命名和概念要与架构章节中对 RAG 模块的描述保持一致。